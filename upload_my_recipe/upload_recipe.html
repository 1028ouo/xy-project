<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>作品分享上傳</title>
      <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
      <!-- <link rel="stylesheet" href="css/style.css"/> -->
      <style>
            @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@200&display=swap');
            *{
                  margin:0;
                  padding:0;
                  box-sizing: border-box;
                  font-family: 'Noto Serif TC', serif;
            }
            .starpic{
                  margin-top: 10px;
                  width:30px;
            }
            .outside{
                  margin:20px;
                  display:flex;
                  justify-content: center;
                  align-items: center;
            }
            .inside{
                  justify-content: center;
                  align-items: center;
                  flex-direction: column;
            }
            .upload{
                  border:none;
                  color: #575757;
                  border-radius: 6px;
                  font-size:15px;
                  font-weight:200;
                  padding:3px 6px;
                  text-decoration: none;
                  float: right;
                  margin-top:10px;
                  font-family: 'Noto Serif TC', serif;
                  cursor:pointer;
            }
            .upload:hover{
                  background:#C3C3C3;
            }
            .recipe{
                  float: left;
            }
            .display_img{
                  padding: 10px;
                  border: 1.5px solid #dbdbdb;
                  width: 350px;
                  height: 250px;
                  text-align:center;
                  box-sizing: border-box;
                  color: gray;
                  display: flex; /*彈性*/
                  justify-content: center;/*使子元素在 Flex 容器中水平居中對齊*/
                  align-items: center;/*子元素在 Flex 容器中垂直居中對齊*/
                  border-radius: 6px;
                  cursor:pointer;
            }
            .display_img:hover{
                  background:#dbdbdb;
            }
            .display_img i{
                  cursor:pointer;
            }
            
            label{
                  font-size: 18px;
                  display: flex;
            }
            input{
                  width:135px;
                  font-size: 15px;
                  height:auto;
                  margin-left: 7px;
                  border-radius: 6px;
                  word-wrap: break-word;
                  padding: 5px;
                  border: 1px solid black;
            }
            textarea{
                  font-size: 15px;
                  padding: 5px;
                  border: 1px solid black;
                  margin-left:7px;
                  border-radius: 6px;
                  resize: none;
            }
            header{
                  top:0px;
                  left:0px;
                  padding:15px 50px;
                  background-color: #d9c3a8;
                  display:flex;
                  text-align: center;
                  justify-content: space-between;
                  align-items: center;
            }
            header h1{
                  color:#373028;
                  width:130px;
                  position:relative;
            }
            header h1::after{
                  content:'';
                  position: absolute;
                  background: #373028;
                  width:100%;
                  height:3px;
                  left:0;
                  bottom: -6px;
                  border-radius: 50px;
                  transform: scaleX(0);
                  transition: transform .3s;
            }
            header h1:hover::after{
                  transform: scaleX(1);
            }
            header a{
                  color: #373028;
                  font-size:20px;
                  font-weight: 1000;
                  text-decoration: none;
                  width:100px;
                  height:45px;
                  background:transparent;
                  border:1.5px solid #5b5043;
                  outline:none;
                  border-radius: 6px;
                  position:relative;
                  line-height: 40px;
                  transition: .3s;
            }
            header a:hover{
                  border:1.5px solid antiquewhite;
                  background: antiquewhite;
                  color:black;
            }
      </style>
</head>
<body>
      <header>
            <h1>作品分享</h1>
            <a href="#">回首頁</a>
      </header>
      <div>       
            <div class="outside">
                  <!-- 輸入地方 -->
                  <div class="inside" style="margin-left: 10px;">

                        <label class="recipe">
                              食譜名稱 : <input type="text" id="recipe" placeholder="請填入食譜名稱" autofocus required>
                        </label><br>

                        <label class="content" style="margin-top: 20px;">
                              <div id="textstar" style="margin-top: 5px;  margin-right:5px;">
                                    實用程度 : </div>
                              <div id="star"></div>
                        </label><br>

                        <label class="content">
                              心得分享 : <textarea rows="10" cols="25" placeholder="想說些什麼？"></textarea>
                        </label><br>

                        <!-- 用來顯示圖片的區域 -->
                        <div id="display_img" class="display_img">
                              <label class="btn btn-info">
                                    <input id="upload_img" style="display:none;" type="file" onchange="previewImage(event)">
                              <i class="fa fa-photo">點擊上傳圖片</i>
                        </label></div>
                        <button id="upload" class="upload">
                              上傳作品
                        </button><br>
                  </div>
            </div>
      </div>

      <script>
            let star=document.getElementById("star");
            let starcnt=0;

            showstar();
            function showstar(){
                  let res='';
                  for(let i=1;i<6;i++){
                        if(i>starcnt)
                              res+=`<i id='star-${i}' onclick='starcount()' class='bx bxs-star' style="color:#dedede; font-size:30px; margin-top:3px; cursor: pointer;"></i>`;
                        else{
                              res+=`<i id='star-${i}' onclick='starcount()' class='bx bxs-star' style="color:#ffed3b; font-size:30px; margin-top:3px; cursor: pointer;"></i>`;
                        }
                  }
                  star.innerHTML=res;
            }
            function starcount(){
                  let id=event.target.id;
                  id=id.split("-");
                  id=parseInt(id[1]);
                  starcnt=id;
                  showstar();
            }

            function previewImage(event) {
                  var input = event.target;//從事件中取得目標元素（此處為 input 元素）
                  var reader = new FileReader();// 創建FileReader物件，用於讀取圖片檔案

                  reader.onload = function(){// 當FileReader讀取完成時執行的動作
                        var imgElement = document.createElement("img");
                        imgElement.src = reader.result;// 將圖片的資料（Data URL）指派給img元素的src屬性
                        imgElement.style.maxWidth = "500px"; // 設定圖片最大寬度
                        document.getElementById("display_img").innerHTML = ""; // 清空預覽區域
                        document.getElementById("display_img").appendChild(imgElement); // 在預覽區域顯示圖片
            };
                  reader.readAsDataURL(input.files[0]);//讀取檔案，將檔案轉換為 Data URL 格式
            }

            document.getElementById("upload").addEventListener("click",function(){
                  let recipe_name = document.getElementById("recipe").value;
                  let star = starcnt;//數量
                  let review = document.querySelector("textarea").value;

                  let data = {
                        recipe_name:recipe_name,
                        star:star,
                        review:review
                  };
                  localStorage.setItem("user_recipe",JSON.stringify(data))
                  window.alert("Upload successful!");
            });
      </script>
</body>
</html>